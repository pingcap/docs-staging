---
title: Local Read under Three Data Centers Deployment
summary: TiDB の 3 つのデータ センター展開モデルでは、センター間のデータ読み取りによりアクセスレイテンシーが長くなる可能性があります。これを軽減するために、 ステイル読み取り機能ではローカルの履歴データ アクセスが可能になり、リアルタイムのデータ可用性を犠牲にしてレイテンシーが短縮されます。地理的に分散されたシナリオでステイル読み取り を使用する場合、TiDB はローカル レプリカにアクセスしてセンター間のネットワークレイテンシーを避けます。これは、`zone` ラベルを構成し、`tidb_replica_read` を `closest-replicas` に設定することで実現されます。Stale ステイル読み取り の実行の詳細については、ドキュメントを参照してください。
---

# 3 つのデータ センター展開でのローカル読み取り {#local-read-under-three-data-centers-deployment}

3 つのデータ センターのモデルでは、リージョンには各データ センターで分離された 3 つのレプリカがあります。ただし、強力な一貫性のある読み取りの要件により、TiDB はすべてのクエリに対して対応するデータのLeaderレプリカにアクセスする必要があります。クエリがLeaderレプリカとは異なるデータ センターで生成された場合、TiDB は別のデータ センターからデータを読み取る必要があり、アクセスのレイテンシーが増加します。

このドキュメントでは、 [ステイル読み取り](/stale-read.md)機能を使用して、センター間アクセスを回避し、リアルタイムのデータ可用性を犠牲にしてアクセスのレイテンシーを減らす方法について説明します。

## 3つのデータセンターのTiDBクラスタをデプロイ {#deploy-a-tidb-cluster-of-three-data-centers}

3データセンター展開方式については、 [1 つの地域展開における複数のデータセンター](/multi-data-centers-in-one-city-deployment.md)を参照してください。

TiKV ノードと TiDB ノードの両方に構成項目`labels`が設定されている場合、同じデータセンター内の TiKV ノードと TiDB ノードは、ラベル`zone`に同じ値を設定する必要があることに注意してください。たとえば、TiKV ノードと TiDB ノードの両方がデータセンター`dc-1`にある場合、2 つのノードを次のラベルで設定する必要があります。

    [labels]
    zone=dc-1

## ステイル読み取りを使用してローカル読み取りを実行する {#perform-local-read-using-stale-read}

[ステイル読み取り](/stale-read.md)は、TiDB がユーザーに履歴データを読み取るために提供するメカニズムです。このメカニズムを使用すると、特定の時点または指定された時間範囲内の対応する履歴データを読み取ることができ、storageノード間のデータ複製によって生じるレイテンシーを節約できます。地理的に分散された展開の一部のシナリオでステイル読み取りを使用する場合、TiDB は、リアルタイム パフォーマンスを犠牲にして、現在のデータ センターのレプリカにアクセスして対応するデータを読み取ります。これにより、センター間の接続によって生じるネットワークレイテンシーが回避され、クエリ プロセス全体のアクセスレイテンシーが短縮されます。

TiDB がステイル読み取りクエリを受信すると、その TiDB ノードの`zone`ラベルが設定されており、 [`tidb_replica_read`](/system-variables.md#tidb_replica_read-new-in-v40)が`closest-replicas`に設定されている場合、TiDB は、対応するデータ レプリカが存在する同じ`zone`ラベルを持つ TiKV ノードに要求を送信します。

ステイル読み取り の実行方法については、 [`AS OF TIMESTAMP`句を使用してステイル読み取りを実行する](/as-of-timestamp.md)参照してください。
