---
title: PingCAP Clinic Overview
summary: PingCAPクリニック は、 TiUPまたはTiDB Operatorを使用して導入された TiDB クラスターの診断サービスです。クラスターの問題をリモートでトラブルシューティングし、安定した動作を保証し、クラスターのステータスをすばやくチェックするのに役立ちます。このサービスには、データ収集用の Diag クライアントと、オンライン診断レポート用の Clinic Server が含まれています。ユーザーは、リモートで問題をトラブルシューティングし、クラスターのステータスをすばやく確認できます。Diag はさまざまな方法で診断データを収集し、Clinic Server にはクラスター、storage、およびデータ サイズに制限があります。このサービスは 2024 年 7 月 14 日まで無料でご利用いただけます。次のステップには、さまざまな環境でPingCAPクリニックを使用することが含まれます。
---

# PingCAPクリニックの概要 {#pingcap-clinic-overview}

PingCAPクリニック診断サービス (PingCAPクリニック) は、 TiUPまたはTiDB Operatorを使用して導入された TiDB クラスター向けに PingCAP が提供する診断サービスです。このサービスは、クラスターの問題をリモートでトラブルシューティングするのに役立ち、クラスターの状態をローカルですばやく確認できます。PingCAP PingCAPクリニックを使用すると、TiDB クラスターのライフサイクル全体にわたる安定した運用を保証し、潜在的な問題を予測し、問題の発生確率を減らし、クラスターの問題をすばやくトラブルシューティングし、クラスターの問題を修正できます。

PingCAPクリニック は、クラスターの問題を診断するために次の 2 つのコンポーネントを提供します。

-   [診断クライアント](https://github.com/pingcap/diag) :

    Diag クライアント (Diag) は、クラスター側に展開されるオープンソースの診断ツールです。Diag は、クラスター診断データを収集し、診断データを Clinic Server にアップロードし、クラスター上でローカルにクイックヘルスチェックを実行するために使用されます。Diag で収集できる診断データの完全なリストについては、 [PingCAPクリニック診断データ](/clinic/clinic-data-instruction-for-tiup.md)参照してください。

    > **注記：**
    >
    > Diag は TiDB v4.0 以降のバージョンをサポートしていますが、TiDB Ansible を使用してデプロイされたクラスターからのデータ収集は**サポートしていません**。

-   クリニックサーバー:

    Clinic Server はクラウドに展開されるクラウド サービスです。SaaS モデルで診断サービスを提供することにより、Clinic Server はアップロードされた診断データを受信するだけでなく、オンライン診断環境として機能してデータを保存、表示し、クラスター診断レポートを提供することもできます。Clinic Server は、storage場所に応じて 2 つの独立したサービスを提供します。

    -   [海外ユーザー向けクリニックサーバー](https://clinic.pingcap.com) : データは米国の AWS に保存されます。
    -   [中国本土のユーザー向けクリニックサーバー](https://clinic.pingcap.com.cn) : データは中国 (北京) リージョンの AWS に保存されます。

## ユーザーシナリオ {#user-scenarios}

-   クラスターの問題をリモートでトラブルシューティングする

    クラスターにすぐには解決できない問題がある場合は、PingCAP またはコミュニティから[支持を得ます](/support.md)入手できます。リモート アシスタンスのためにテクニカル サポートに連絡する場合、クラスターからさまざまな診断データを保存し、サポート スタッフにデータを転送する必要があります。この場合、Diag を使用すると、ワンクリックで診断データを収集できます。Diag を使用すると、完全な診断データをすばやく収集できるため、複雑な手動のデータ収集操作を回避できます。データを収集したら、データを Clinic Server にアップロードして、PingCAP テクニカル サポート スタッフがクラスターの問題をトラブルシューティングできます。Clinic Server は、アップロードされた診断データを安全にstorageし、オンライン診断をサポートしているため、トラブルシューティングの効率が大幅に向上します。

-   クラスターのステータスを素早く確認

    現時点ではクラスターが安定して動作している場合でも、潜在的な安定性リスクを検出するために、クラスターを定期的にチェックする必要があります。PingCAP PingCAPクリニックが提供するローカルおよびサーバー側のクイック チェック機能を使用して、クラスターの潜在的な健全性リスクを特定できます。

## 実施原則 {#implementation-principles}

このセクションでは、Diag がクラスターから診断データを収集する方法に関する実装原則について説明します。

まず、Diag はデプロイメント ツールTiUP (tiup-cluster) またはTiDB Operator (tidb-operator) からクラスター トポロジ情報を取得します。次に、Diag は次のようなさまざまなデータ収集方法を通じて、さまざまな種類の診断データを収集します。

-   SCP 経由でサーバーファイルを転送する

    TiUPを使用して展開されたクラスターの場合、Diag はセキュリティコピー プロトコル (SCP) を介してターゲットコンポーネントのノードからログ ファイルと構成ファイルを直接収集できます。

-   SSH経由でリモートコマンドを実行してデータを収集する

    TiUPを使用して展開されたクラスターの場合、Diag は SSH ( セキュリティ Shell) を介してターゲットコンポーネントシステムに接続し、コマンド (Insight など) を実行して、カーネル ログ、カーネル パラメーター、システムとハードウェアの基本情報などのシステム情報を取得できます。

-   HTTP呼び出しを通じてデータを収集する

    -   Diag は、TiDB コンポーネントの HTTP インターフェイスを呼び出すことで、TiDB、TiKV、PD などのコンポーネントのリアルタイム構成サンプリング情報とリアルタイム パフォーマンス サンプリング情報を取得できます。
    -   Prometheus の HTTP インターフェースを呼び出すことで、Diag はアラート情報と監視メトリック データを取得できます。

-   SQL ステートメントを使用してデータベース パラメータをクエリする

    Diag は SQL ステートメントを使用して、TiDB のシステム変数やその他の情報を照会できます。この方法を使用するには、データ収集時に TiDB にアクセスするためのユーザー名とパスワード**を追加で提供する**必要があります。

## クリニックサーバーの限界 {#the-limitations-of-clinic-server}

> **注記：**
>
> -   Clinic Serverは2022年7月15日から2024年12月31日まで無料です。それ以降にサービスが有料になる場合は、2024年12月31日までにメールでお知らせします。
> -   使用制限を調整する場合は、PingCAP から[支持を得ます](/support.md)実行します。

| サービスの種類       | 制限          |
| :------------ | :---------- |
| クラスターの数       | 10/組織       |
| ストレージ容量       | 50 GB/クラスター |
| 保管期間          | 180日        |
| データサイズ        | 3 GB/パッケージ  |
| データ再構築環境の保存期間 | 3日          |

## 次のステップ {#next-step}

-   オンプレミス環境でPingCAPクリニックを使用する
    -   [PingCAPクリニックのクイックスタート](/clinic/quick-start-with-clinic.md)
    -   [PingCAPクリニックを使用してクラスターをトラブルシューティングする](/clinic/clinic-user-guide-for-tiup.md)
    -   [PingCAPクリニック診断データ](/clinic/clinic-data-instruction-for-tiup.md)

-   Kubernetes でPingCAPクリニックを使用する
    -   [PingCAPクリニックを使用して TiDBクラスタをトラブルシューティングする](https://docs.pingcap.com/tidb-in-kubernetes/stable/clinic-user-guide)
    -   [PingCAPクリニック診断データ](https://docs.pingcap.com/tidb-in-kubernetes/stable/clinic-data-collection)
